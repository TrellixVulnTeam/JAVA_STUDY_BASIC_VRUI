<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.kr.jongin.blog.blog.BlogMapper">


	<resultMap id="blogMap" type="blog"> 
		<result column="blog_no" property="blogNo"/>
		<result column="member_no" property="memberNo"/>
		<result column="title" property="title"/>
		<result column="tag" property="tag"/>
		<result column="logo_no" property="logoNo"/>
		<result column="show_num" property="showNum"/>
		<result column="visit" property="visit"/>
		<result column="id" property="id"/>
	</resultMap>

	<insert id="blogInsert" parameterType="blog">
		insert into BLOGS
			(blog_no,member_no,title)
		values
			(BLOG_NO_SQ.NEXTVAL,#{memberNo},#{title})
	</insert>
	
	<select id="chkMyBlog" parameterType="int" resultType="int">
		select count(*)
			from
		BLOGS
			where member_no = #{member_no}
	</select>
	
	<select id="blogDetail" parameterType="int" resultMap="blogMap">
		select *
			from BLOGS
		where blog_no = #{blogNo}
	</select>
	
	<select id="myBlogDetail" parameterType="int" resultMap="blogMap">
		select *
			from BLOGS
		where member_no = #{memberNo}
	</select>

	<select id="blogList" parameterType="blog" resultMap="blogMap">
		select b.*, m.id
			from BLOGS b
				inner join MEMBERS m
			on b.MEMBER_NO = m.MEMBER_NO
		<include refid="whereSearch" />
		order by blog_no
	</select>
	
	<sql id="whereSearch">
		<where>
			<if test="column == 'title'">
	    		title like '%' || #{word} || '%'		
			</if>
			<if test="column == 'tag'">
	    		and tag like '%' || #{word} || '%'		
			</if>
			<if test="column == 'memberNo'">
	    		and id like '%' || #{word} || '%'		
			</if>
    	</where>
	</sql>
	
</mapper>






























